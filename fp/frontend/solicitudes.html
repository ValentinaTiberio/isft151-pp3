<body>
  <header><h1>Mis solicitudes</h1></header>
  <main>
    <div id="solicitudesContainer"></div>
  </main>

  <script>
    const userId = localStorage.getItem("user_id");

    async function cargarMisSolicitudes() {
      const adopciones = await fetch(`http://127.0.0.1:5000/api/adopciones/usuario/${userId}`).then(r => r.json());
      const transitos = await fetch(`http://127.0.0.1:5000/api/transitos/usuario/${userId}`).then(r => r.json());

      const todas = [
        ...adopciones.map(a => ({ tipo: "Adopción", ...a })),
        ...transitos.map(t => ({ tipo: "Tránsito", ...t }))
      ];

      const div = document.getElementById("solicitudesContainer");
      if (todas.length === 0) {
        div.innerHTML = "<p>No tenés solicitudes aún.</p>";
        return;
      }

      div.innerHTML = todas.map(s => `
        <div style="background:white;padding:10px;margin:10px;border-radius:10px;box-shadow:0px 2px 5px rgba(0,0,0,0.1)">
          <h3>${s.animal_nombre || "Animal sin nombre"}</h3>
          <p><b>Tipo:</b> ${s.tipo}</p>
          <p><b>Estado:</b> ${s.estado}</p>
          <p><b>Fecha:</b> ${s.fecha_solicitud}</p>
          ${s.tipo === "Tránsito" ? `
            <p><b>Dirección ofrecida:</b> ${s.direccion}</p>
            <p><b>Días ofrecidos:</b> ${s.duracion_dias}</p>
          ` : ""}
        </div>
      `).join("");
    }

    cargarMisSolicitudes();
  </script>
</body>
